# Railroad
Решение задачи сегментации рабочей железнодорожной машины на размеченном датасете и задачи сегментации железнодорожны рельс на неразмеченных данных.

Я постарался решать оба задания паралельно:
1)К задаче сегментации машины я решил подойти с использованием актуальных архитектур, YOLOv8+SAM:
  -данный подход был выбран ввиду того что данные модели очень хорошо зарекомендовали себя на различных задачах и я посчитал необходимым показать знакомство с ними
  -оценивал mAP (mean average precisin) в процессе обучения детектора YOLOv8, все метрики в задачах сегментации связаны с IoU (Intersection over Union) но в данном примере в качестве аннотаций у меня были только box'ы и я оценивал качество сегментации на глаз.
  -все подробности и код представлены в ноутбуке yellowcar/smallyellowcar.ipynb

2)На задачу сегментации рельс осталась не так много времени и я решил прибегнуть к бейзлайн решению. В связи с тем что разметки у данных не было я решил сначала использовать Labelbox и сделал попиксельную разметку для ~60фотографий.
Я планировал обучить на полученным наборе данных простую модель(Unet), доразметить оставшиеся изображения ее силами и уже с на всем наборе данных обучить ансамбль из Unet, PSPNet и PAN.
К сожалению не смотря на то что Labelbox является крайне удобным инструментом аннотирования и содержит встроенные модели похожие на SAM, разметка заняла у меня больше времени чем планировалось и до ансамбля я так и недобрался (в процессе).
Вынужден обратить внимание что так как гпу память на колабе была исчерпана первой задачей, вторую я запускал на своем железе в связи с чем вместо ноутбука прикладываю несколько .py файлов с необходимыми коментариями.
  -в качестве Loss функции были протестированы BCELoss, DiceLoss, JaccardLoss, лучше всего себя показал Dice
  -в качестве метрик были замерены IoU, Dice coef, Pixel Accuracy
  -чтобы разнообразить совсем скудный набор размеченных ихображений я применял различные аугментации
К сожалению на сегодняшний день я не могу сказать что преуспел в данном задании но у меня есть план действий. Если идея с ансамблированием не покажет себя, я попробую сделать разметку регионами интересов и использовать для задачи более современные архитектуры. Конечно можно было бы разметить побольше изображений. Так же я пытался осуществить сегментацию силами opencv но в этом подходе совсем не преуспел и спустя потраченный вечер оставил эту затею, возможно ей тоже стоит уделить больше внимания.
  

  
